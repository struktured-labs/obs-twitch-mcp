<!DOCTYPE html>
<html>
<head>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: transparent;
    width: 1920px;
    height: 1080px;
    overflow: hidden;
    position: relative;
  }

  .dove-container {
    position: absolute;
    width: 180px;
    height: 180px;
    transform-origin: center center;
    filter: drop-shadow(0 0 8px rgba(200, 50, 50, 0.6));
    z-index: 100;
  }

  .dove {
    width: 100%;
    height: 100%;
    object-fit: contain;
    transform-origin: center center;
  }

  /* Wing flap animation */
  @keyframes wingFlap {
    0%, 100% { transform: scaleY(1); }
    50% { transform: scaleY(0.92); }
  }

  .dove.flying {
    animation: wingFlap 0.15s ease-in-out infinite;
  }

  /* Glide animation - slower, smoother */
  .dove.gliding {
    animation: glide 2s ease-in-out infinite;
  }

  @keyframes glide {
    0%, 100% { transform: rotate(0deg) translateY(0); }
    25% { transform: rotate(-2deg) translateY(-3px); }
    75% { transform: rotate(2deg) translateY(3px); }
  }

  /* Trail feathers */
  .feather {
    position: absolute;
    width: 8px;
    height: 20px;
    background: linear-gradient(to bottom, #cc3333, #882222);
    border-radius: 50% 50% 50% 50% / 80% 80% 20% 20%;
    opacity: 0.7;
    pointer-events: none;
    animation: featherFall 2s ease-out forwards;
  }

  @keyframes featherFall {
    0% { opacity: 0.7; transform: rotate(0deg) translateY(0); }
    100% { opacity: 0; transform: rotate(360deg) translateY(100px); }
  }

  /* Sparkle trail */
  .sparkle {
    position: absolute;
    width: 6px;
    height: 6px;
    background: radial-gradient(circle, #ffcccc 0%, #ff6666 50%, transparent 70%);
    border-radius: 50%;
    pointer-events: none;
    animation: sparkle 0.8s ease-out forwards;
  }

  @keyframes sparkle {
    0% { opacity: 1; transform: scale(1); }
    100% { opacity: 0; transform: scale(0); }
  }
</style>
</head>
<body>

<div class="dove-container" id="dove">
  <img class="dove flying" src="file:///home/struktured/Pictures/darkreddove-profile.png" alt="DarkRedDove">
</div>

<script>
const dove = document.getElementById('dove');
const doveImg = dove.querySelector('.dove');

// Scene bounds
const sceneWidth = 1920;
const sceneHeight = 1080;
const doveSize = 180;

// Current position and velocity
let x = Math.random() * (sceneWidth - doveSize);
let y = Math.random() * (sceneHeight - doveSize);
let vx = 2 + Math.random() * 2;
let vy = 0.5 + Math.random();
let targetX = Math.random() * sceneWidth;
let targetY = Math.random() * sceneHeight;

// State
let isSwooping = false;
let swoopPhase = 0;
let swoopStartY = 0;
let glideTimer = 0;
let featherTimer = 0;

// Direction facing
let facingRight = true;

function updatePosition() {
  if (isSwooping) {
    // Swoop animation - dive down then up
    swoopPhase += 0.03;
    if (swoopPhase < Math.PI) {
      // Diving down
      const swoopDepth = 200;
      y = swoopStartY + Math.sin(swoopPhase) * swoopDepth;
      x += vx * 1.5; // Move faster during swoop

      // Rotate during swoop
      const angle = Math.sin(swoopPhase) * 30;
      doveImg.style.transform = `rotate(${facingRight ? angle : -angle}deg)`;

      // More feathers during swoop
      if (Math.random() < 0.3) {
        createFeather(x + doveSize/2, y + doveSize/2);
      }
    } else {
      // End swoop
      isSwooping = false;
      swoopPhase = 0;
      doveImg.style.transform = '';
      pickNewTarget();
    }
  } else {
    // Normal flight - smoothly move toward target
    const dx = targetX - x;
    const dy = targetY - y;
    const dist = Math.sqrt(dx * dx + dy * dy);

    if (dist < 50) {
      pickNewTarget();
    } else {
      // Smooth acceleration toward target
      vx += (dx / dist) * 0.1;
      vy += (dy / dist) * 0.1;

      // Limit speed
      const speed = Math.sqrt(vx * vx + vy * vy);
      const maxSpeed = 4;
      if (speed > maxSpeed) {
        vx = (vx / speed) * maxSpeed;
        vy = (vy / speed) * maxSpeed;
      }

      // Add slight bobbing
      vy += Math.sin(Date.now() / 500) * 0.05;
    }

    x += vx;
    y += vy;

    // Glide animation toggle
    glideTimer++;
    if (glideTimer > 100 && Math.random() < 0.01) {
      doveImg.classList.remove('flying');
      doveImg.classList.add('gliding');
      glideTimer = 0;
      setTimeout(() => {
        doveImg.classList.remove('gliding');
        doveImg.classList.add('flying');
      }, 2000);
    }

    // Random chance to swoop
    if (Math.random() < 0.002 && y < sceneHeight / 2) {
      startSwoop();
    }
  }

  // Keep in bounds
  if (x < 0) { x = 0; vx = Math.abs(vx); pickNewTarget(); }
  if (x > sceneWidth - doveSize) { x = sceneWidth - doveSize; vx = -Math.abs(vx); pickNewTarget(); }
  if (y < 50) { y = 50; vy = Math.abs(vy); }
  if (y > sceneHeight - doveSize - 50) { y = sceneHeight - doveSize - 50; vy = -Math.abs(vy); }

  // Update facing direction
  if (vx > 0.5 && !facingRight) {
    facingRight = true;
    dove.style.transform = `scaleX(1)`;
  } else if (vx < -0.5 && facingRight) {
    facingRight = false;
    dove.style.transform = `scaleX(-1)`;
  }

  // Apply position
  dove.style.left = x + 'px';
  dove.style.top = y + 'px';

  // Occasional feather
  featherTimer++;
  if (featherTimer > 60 && Math.random() < 0.02) {
    createFeather(x + doveSize/2, y + doveSize);
    featherTimer = 0;
  }

  // Trail sparkles while moving fast
  const speed = Math.sqrt(vx * vx + vy * vy);
  if (speed > 2 && Math.random() < 0.2) {
    createSparkle(x + doveSize/2 + (Math.random() - 0.5) * 30, y + doveSize/2 + (Math.random() - 0.5) * 30);
  }

  requestAnimationFrame(updatePosition);
}

function pickNewTarget() {
  // Pick a new random target position
  targetX = 100 + Math.random() * (sceneWidth - 200);
  targetY = 100 + Math.random() * (sceneHeight - 300);

  // Sometimes pick corners or edges for more interesting paths
  if (Math.random() < 0.3) {
    const corner = Math.floor(Math.random() * 4);
    switch(corner) {
      case 0: targetX = 100; targetY = 100; break;
      case 1: targetX = sceneWidth - 200; targetY = 100; break;
      case 2: targetX = 100; targetY = sceneHeight - 200; break;
      case 3: targetX = sceneWidth - 200; targetY = sceneHeight - 200; break;
    }
  }
}

function startSwoop() {
  isSwooping = true;
  swoopPhase = 0;
  swoopStartY = y;
  doveImg.classList.remove('gliding');
  doveImg.classList.add('flying');
}

function createFeather(fx, fy) {
  const feather = document.createElement('div');
  feather.className = 'feather';
  feather.style.left = fx + 'px';
  feather.style.top = fy + 'px';
  feather.style.transform = `rotate(${Math.random() * 360}deg)`;
  document.body.appendChild(feather);
  setTimeout(() => feather.remove(), 2000);
}

function createSparkle(sx, sy) {
  const sparkle = document.createElement('div');
  sparkle.className = 'sparkle';
  sparkle.style.left = sx + 'px';
  sparkle.style.top = sy + 'px';
  document.body.appendChild(sparkle);
  setTimeout(() => sparkle.remove(), 800);
}

// Start animation
updatePosition();

// Occasionally trigger a swoop
setInterval(() => {
  if (!isSwooping && Math.random() < 0.3) {
    startSwoop();
  }
}, 15000);
</script>
</body>
</html>
