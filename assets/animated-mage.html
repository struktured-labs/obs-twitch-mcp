<!DOCTYPE html>
<html>
<head>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: transparent;
    width: 3840px;
    height: 2160px;
    overflow: hidden;
    position: relative;
  }

  .mage-container {
    position: absolute;
    left: 1080px;
    top: 1454px;
    width: 613px;
    height: 613px;
    transform-origin: center center;
  }

  .mage {
    width: 100%;
    height: 100%;
    object-fit: contain;
    transform-origin: center center;
    animation: lookAround 16s ease-in-out infinite;
    filter: drop-shadow(0 0 12px rgba(138, 43, 226, 0.6));
  }

  @keyframes lookAround {
    0% { transform: scaleX(1) rotate(0deg) translateY(0); }
    8% { transform: scaleX(1) rotate(-4deg) translateY(-5px); }
    15% { transform: scaleX(1) rotate(2deg) translateY(3px); }
    22% { transform: scaleX(1) rotate(0deg) translateY(0); }
    30% { transform: scaleX(-1) rotate(0deg) translateY(0); }
    38% { transform: scaleX(-1) rotate(3deg) translateY(-8px); }
    45% { transform: scaleX(-1) rotate(-2deg) translateY(5px); }
    52% { transform: scaleX(-1) rotate(4deg) translateY(-3px); }
    60% { transform: scaleX(-1) rotate(0deg) translateY(0); }
    68% { transform: scaleX(1) rotate(0deg) translateY(0); }
    75% { transform: scaleX(1) rotate(-3deg) translateY(6px); }
    82% { transform: scaleX(1) rotate(5deg) translateY(-10px); }
    90% { transform: scaleX(1) rotate(-2deg) translateY(4px); }
    100% { transform: scaleX(1) rotate(0deg) translateY(0); }
  }

  .spell-burst {
    position: absolute;
    pointer-events: none;
    font-size: 140px;
    animation: burstIn 0.3s ease-out, burstOut 2.5s ease-in 0.3s forwards;
    text-shadow: 0 0 40px currentColor, 0 0 80px currentColor, 0 0 120px currentColor;
    z-index: 100;
  }

  @keyframes burstIn {
    0% { transform: scale(0) rotate(-180deg); opacity: 0; }
    100% { transform: scale(1.3) rotate(0deg); opacity: 1; }
  }

  @keyframes burstOut {
    0% { transform: scale(1.3); opacity: 1; }
    50% { transform: scale(2); opacity: 0.8; }
    100% { transform: scale(3); opacity: 0; }
  }

  /* ULTIMA - massive green explosion */
  .spell-ultima {
    font-size: 200px;
    animation: ultimaBurst 0.5s ease-out, ultimaFade 3s ease-in 0.5s forwards;
    text-shadow: 0 0 60px #22ff22, 0 0 120px #22ff22, 0 0 180px #00ff00, 0 0 240px #00aa00;
  }
  @keyframes ultimaBurst {
    0% { transform: scale(0) rotate(0deg); opacity: 0; }
    50% { transform: scale(2) rotate(180deg); opacity: 1; }
    100% { transform: scale(1.5) rotate(360deg); opacity: 1; }
  }
  @keyframes ultimaFade {
    0% { transform: scale(1.5); opacity: 1; }
    100% { transform: scale(4); opacity: 0; }
  }

  /* FLARE - bright orange/red massive burst */
  .spell-flare {
    font-size: 180px;
    animation: flareBurst 0.4s ease-out, flareFade 2s ease-in 0.4s forwards;
    text-shadow: 0 0 50px #ff6600, 0 0 100px #ff4400, 0 0 150px #ff0000;
  }
  @keyframes flareBurst {
    0% { transform: scale(0); opacity: 0; filter: brightness(3); }
    100% { transform: scale(1.8); opacity: 1; filter: brightness(1.5); }
  }
  @keyframes flareFade {
    0% { transform: scale(1.8); opacity: 1; }
    100% { transform: scale(3); opacity: 0; }
  }

  /* GRAVITY - purple/black pulling effect */
  .spell-gravity {
    font-size: 160px;
    animation: gravityPulse 2s ease-in-out forwards;
    text-shadow: 0 0 40px #8800ff, 0 0 80px #6600cc, 0 0 120px #440088;
  }
  @keyframes gravityPulse {
    0% { transform: scale(2); opacity: 0; }
    30% { transform: scale(0.8); opacity: 1; }
    50% { transform: scale(1.2); opacity: 1; }
    70% { transform: scale(0.6); opacity: 1; }
    100% { transform: scale(0); opacity: 0; }
  }

  /* DOOMSDAY - dark apocalyptic */
  .spell-doomsday {
    font-size: 220px;
    animation: doomRise 0.8s ease-out, doomFade 3s ease-in 0.8s forwards;
    text-shadow: 0 0 60px #ff0000, 0 0 120px #880000, 0 0 180px #440000;
    filter: saturate(1.5);
  }
  @keyframes doomRise {
    0% { transform: scale(0) translateY(100px); opacity: 0; }
    100% { transform: scale(1.5) translateY(0); opacity: 1; }
  }
  @keyframes doomFade {
    0% { transform: scale(1.5); opacity: 1; }
    50% { transform: scale(2.5); opacity: 0.8; }
    100% { transform: scale(4); opacity: 0; }
  }

  /* BLIZZARD - icy blue */
  .spell-blizzard {
    font-size: 150px;
    animation: blizzardSpin 0.5s ease-out, blizzardFade 2.5s ease-in 0.5s forwards;
    text-shadow: 0 0 40px #00ffff, 0 0 80px #00ccff, 0 0 120px #0088ff;
  }
  @keyframes blizzardSpin {
    0% { transform: scale(0) rotate(-360deg); opacity: 0; }
    100% { transform: scale(1.4) rotate(0deg); opacity: 1; }
  }
  @keyframes blizzardFade {
    0% { transform: scale(1.4); opacity: 1; }
    100% { transform: scale(2.5); opacity: 0; filter: blur(10px); }
  }

  /* BIO - poison green bubbles */
  .spell-bio {
    font-size: 130px;
    animation: bioBubble 3s ease-in-out forwards;
    text-shadow: 0 0 30px #88ff00, 0 0 60px #66cc00, 0 0 90px #448800;
  }
  @keyframes bioBubble {
    0% { transform: scale(0); opacity: 0; }
    20% { transform: scale(1.2); opacity: 1; }
    40% { transform: scale(1.0); opacity: 1; }
    60% { transform: scale(1.3); opacity: 0.9; }
    80% { transform: scale(1.1); opacity: 0.7; }
    100% { transform: scale(1.5); opacity: 0; }
  }

  /* METEOR - fiery descent */
  .spell-meteor {
    font-size: 170px;
    animation: meteorFall 0.6s ease-in, meteorExplode 2s ease-out 0.6s forwards;
    text-shadow: 0 0 50px #ff4400, 0 0 100px #ff2200, 0 0 150px #cc0000;
  }
  @keyframes meteorFall {
    0% { transform: translateY(-200px) scale(0.5); opacity: 0.5; }
    100% { transform: translateY(0) scale(1.5); opacity: 1; }
  }
  @keyframes meteorExplode {
    0% { transform: scale(1.5); opacity: 1; }
    30% { transform: scale(2.5); opacity: 1; }
    100% { transform: scale(4); opacity: 0; }
  }

  .magic-ring {
    position: absolute;
    border: 6px solid;
    border-radius: 50%;
    pointer-events: none;
    animation: ringExpand 1.5s ease-out forwards;
  }

  @keyframes ringExpand {
    0% { transform: scale(0); opacity: 1; }
    100% { transform: scale(5); opacity: 0; }
  }

  .gravity-ring {
    animation: gravityRing 1.5s ease-in forwards;
  }
  @keyframes gravityRing {
    0% { transform: scale(5); opacity: 0.3; }
    100% { transform: scale(0); opacity: 1; }
  }

  .magic-particle {
    position: absolute;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    pointer-events: none;
  }

  .trail-spark {
    position: absolute;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    pointer-events: none;
    animation: sparkle 0.8s ease-out forwards;
  }

  @keyframes sparkle {
    0% { opacity: 1; transform: scale(2); }
    50% { opacity: 1; transform: scale(1.2); }
    100% { opacity: 0; transform: scale(0); }
  }

  .cast-flash {
    position: absolute;
    width: 200px;
    height: 200px;
    border-radius: 50%;
    pointer-events: none;
    animation: flash 0.5s ease-out forwards;
    filter: blur(30px);
  }

  @keyframes flash {
    0% { transform: scale(0); opacity: 1; }
    50% { transform: scale(2.5); opacity: 0.9; }
    100% { transform: scale(4); opacity: 0; }
  }

  .ice-shard {
    position: absolute;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-bottom: 30px solid;
    pointer-events: none;
    animation: shardFly 1s ease-out forwards;
  }
  @keyframes shardFly {
    0% { opacity: 1; transform: rotate(0deg) scale(1); }
    100% { opacity: 0; transform: rotate(720deg) scale(0); }
  }

  .poison-bubble {
    position: absolute;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    pointer-events: none;
    animation: bubbleFloat 2s ease-out forwards;
  }
  @keyframes bubbleFloat {
    0% { opacity: 0.8; transform: translateY(0) scale(1); }
    100% { opacity: 0; transform: translateY(-150px) scale(0.3); }
  }

  /* Staff */
  .staff {
    position: absolute;
    right: 40px;
    top: 80px;
    transform-origin: bottom center;
    animation: staffBob 16s ease-in-out infinite;
    z-index: 5;
  }

  @keyframes staffBob {
    0%, 100% { transform: rotate(-5deg); }
    25% { transform: rotate(-8deg); }
    50% { transform: rotate(-3deg); }
    75% { transform: rotate(-10deg); }
  }

  .staff-shaft {
    width: 18px;
    height: 380px;
    background: linear-gradient(90deg, #2a1a0a 0%, #5a3a1a 30%, #8b5a2b 50%, #5a3a1a 70%, #2a1a0a 100%);
    border-radius: 8px;
    box-shadow: 2px 4px 8px rgba(0,0,0,0.5);
  }

  .staff-orb {
    position: absolute;
    top: -50px;
    left: 50%;
    transform: translateX(-50%);
    width: 70px;
    height: 70px;
    background: radial-gradient(circle at 30% 30%, #ff88ff, #aa22aa 40%, #660066 70%, #330033);
    border-radius: 50%;
    box-shadow:
      0 0 30px #ff00ff,
      0 0 60px #aa00aa,
      0 0 90px #660066,
      inset 0 0 20px rgba(255,255,255,0.3);
    animation: orbPulse 3s ease-in-out infinite;
  }

  .staff-orb-glow {
    position: absolute;
    top: -70px;
    left: 50%;
    transform: translateX(-50%);
    width: 110px;
    height: 110px;
    background: radial-gradient(circle, rgba(255,0,255,0.4) 0%, transparent 70%);
    border-radius: 50%;
    animation: orbGlow 2s ease-in-out infinite alternate;
    pointer-events: none;
  }

  @keyframes orbPulse {
    0%, 100% {
      box-shadow: 0 0 30px #ff00ff, 0 0 60px #aa00aa, 0 0 90px #660066, inset 0 0 20px rgba(255,255,255,0.3);
      transform: translateX(-50%) scale(1);
    }
    50% {
      box-shadow: 0 0 50px #ff44ff, 0 0 90px #cc00cc, 0 0 130px #880088, inset 0 0 30px rgba(255,255,255,0.5);
      transform: translateX(-50%) scale(1.1);
    }
  }

  @keyframes orbGlow {
    0% { opacity: 0.5; transform: translateX(-50%) scale(1); }
    100% { opacity: 1; transform: translateX(-50%) scale(1.3); }
  }

  /* DARK magic spells */
  .spell-dark {
    font-size: 160px;
    animation: darkSwirl 0.6s ease-out, darkFade 2.5s ease-in 0.6s forwards;
    text-shadow: 0 0 40px #220044, 0 0 80px #110022, 0 0 120px #000000;
    filter: brightness(0.7);
  }
  @keyframes darkSwirl {
    0% { transform: scale(0) rotate(180deg); opacity: 0; filter: brightness(0); }
    100% { transform: scale(1.4) rotate(0deg); opacity: 1; filter: brightness(0.7); }
  }
  @keyframes darkFade {
    0% { transform: scale(1.4); opacity: 1; }
    100% { transform: scale(2.5); opacity: 0; }
  }

  /* STOP/TIME magic */
  .spell-stop {
    font-size: 150px;
    animation: stopFreeze 3s ease-in-out forwards;
    text-shadow: 0 0 40px #ffff00, 0 0 80px #cccc00;
  }
  @keyframes stopFreeze {
    0% { transform: scale(0) rotate(720deg); opacity: 0; }
    30% { transform: scale(1.5) rotate(0deg); opacity: 1; }
    70% { transform: scale(1.5) rotate(0deg); opacity: 1; }
    100% { transform: scale(0) rotate(-720deg); opacity: 0; }
  }

  /* CURSE */
  .spell-curse {
    font-size: 140px;
    animation: cursePulse 2.5s ease-in-out forwards;
    text-shadow: 0 0 30px #880088, 0 0 60px #440044;
    filter: hue-rotate(0deg);
  }
  @keyframes cursePulse {
    0% { transform: scale(0); opacity: 0; filter: hue-rotate(0deg); }
    25% { transform: scale(1.3); opacity: 1; filter: hue-rotate(60deg); }
    50% { transform: scale(1.1); opacity: 1; filter: hue-rotate(120deg); }
    75% { transform: scale(1.4); opacity: 0.8; filter: hue-rotate(180deg); }
    100% { transform: scale(0.5); opacity: 0; filter: hue-rotate(360deg); }
  }

  /* SLEEP */
  .spell-sleep {
    font-size: 120px;
    animation: sleepFloat 3s ease-in-out forwards;
    text-shadow: 0 0 30px #8888ff, 0 0 60px #4444cc;
  }
  @keyframes sleepFloat {
    0% { transform: scale(0) translateY(50px); opacity: 0; }
    30% { transform: scale(1.2) translateY(0); opacity: 1; }
    100% { transform: scale(0.8) translateY(-100px); opacity: 0; }
  }

  /* BREAK/STONE */
  .spell-break {
    font-size: 160px;
    animation: breakShatter 2s ease-out forwards;
    text-shadow: 0 0 30px #888888, 0 0 60px #666666;
  }
  @keyframes breakShatter {
    0% { transform: scale(0); opacity: 0; }
    20% { transform: scale(1.5); opacity: 1; }
    40% { transform: scale(1.3) rotate(5deg); opacity: 1; }
    60% { transform: scale(1.4) rotate(-5deg); opacity: 1; }
    80% { transform: scale(1.2) rotate(0deg); opacity: 0.8; }
    100% { transform: scale(2) rotate(0deg); opacity: 0; }
  }

  /* WATER/FLOOD - flowing blue wave */
  .spell-water {
    font-size: 160px;
    animation: waterWave 2.5s ease-in-out forwards;
    text-shadow: 0 0 40px #0066ff, 0 0 80px #0044cc, 0 0 120px #002288;
  }
  @keyframes waterWave {
    0% { transform: scale(0) translateX(-100px); opacity: 0; }
    30% { transform: scale(1.3) translateX(0); opacity: 1; }
    60% { transform: scale(1.1) translateX(50px); opacity: 1; }
    100% { transform: scale(1.5) translateX(100px); opacity: 0; }
  }

  /* AERO/WIND - spinning vortex */
  .spell-aero {
    font-size: 150px;
    animation: aeroSpin 2s ease-out forwards;
    text-shadow: 0 0 30px #88ffcc, 0 0 60px #44cc88, 0 0 90px #22aa66;
  }
  @keyframes aeroSpin {
    0% { transform: scale(0) rotate(0deg); opacity: 0; }
    50% { transform: scale(1.4) rotate(540deg); opacity: 1; }
    100% { transform: scale(2) rotate(1080deg); opacity: 0; }
  }

  /* MELTDOWN - nuclear fusion */
  .spell-meltdown {
    font-size: 200px;
    animation: meltdownPulse 3s ease-out forwards;
    text-shadow: 0 0 60px #ffff00, 0 0 120px #ff8800, 0 0 180px #ff4400;
    filter: brightness(1.5);
  }
  @keyframes meltdownPulse {
    0% { transform: scale(0); opacity: 0; filter: brightness(3); }
    20% { transform: scale(2); opacity: 1; filter: brightness(2); }
    40% { transform: scale(1.5); opacity: 1; filter: brightness(1.5); }
    60% { transform: scale(2.2); opacity: 0.9; filter: brightness(2); }
    100% { transform: scale(3); opacity: 0; filter: brightness(1); }
  }

  /* SCATHE - dark laser beam */
  .spell-scathe {
    font-size: 180px;
    animation: scatheBeam 2s ease-out forwards;
    text-shadow: 0 0 50px #ff00ff, 0 0 100px #cc00cc, 0 0 150px #880088;
  }
  @keyframes scatheBeam {
    0% { transform: scale(0.2, 3) translateY(-100px); opacity: 0; }
    30% { transform: scale(1.5, 1.5) translateY(0); opacity: 1; }
    100% { transform: scale(2.5) translateY(50px); opacity: 0; }
  }

  /* BANISH - holy smite */
  .spell-banish {
    font-size: 170px;
    animation: banishFlash 2s ease-out forwards;
    text-shadow: 0 0 60px #ffffff, 0 0 120px #ffffcc, 0 0 180px #ffff88;
    filter: brightness(2);
  }
  @keyframes banishFlash {
    0% { transform: scale(0) rotate(-90deg); opacity: 0; filter: brightness(4); }
    30% { transform: scale(1.8) rotate(0deg); opacity: 1; filter: brightness(2); }
    60% { transform: scale(1.5) rotate(90deg); opacity: 1; filter: brightness(1.5); }
    100% { transform: scale(0) rotate(180deg); opacity: 0; filter: brightness(1); }
  }

  /* WARP/X-ZONE - dimensional rift */
  .spell-warp {
    font-size: 160px;
    animation: warpRift 2.5s ease-in-out forwards;
    text-shadow: 0 0 40px #8800ff, 0 0 80px #4400aa, 0 0 120px #220066;
    filter: hue-rotate(0deg);
  }
  @keyframes warpRift {
    0% { transform: scale(0) rotate(0deg); opacity: 0; filter: hue-rotate(0deg); }
    25% { transform: scale(2) rotate(180deg); opacity: 1; filter: hue-rotate(90deg); }
    50% { transform: scale(0.5) rotate(360deg); opacity: 1; filter: hue-rotate(180deg); }
    75% { transform: scale(1.5) rotate(540deg); opacity: 0.8; filter: hue-rotate(270deg); }
    100% { transform: scale(0) rotate(720deg); opacity: 0; filter: hue-rotate(360deg); }
  }

  /* RUIN - destructive force */
  .spell-ruin {
    font-size: 170px;
    animation: ruinCrush 2s ease-in forwards;
    text-shadow: 0 0 50px #440044, 0 0 100px #220022, 0 0 150px #110011;
  }
  @keyframes ruinCrush {
    0% { transform: scale(3) translateY(-150px); opacity: 0; }
    40% { transform: scale(1.5) translateY(0); opacity: 1; }
    60% { transform: scale(1.8) translateY(20px); opacity: 1; }
    100% { transform: scale(0.5) translateY(50px); opacity: 0; }
  }

  /* BURST - energy explosion */
  .spell-burst-energy {
    font-size: 180px;
    animation: burstEnergy 1.5s ease-out forwards;
    text-shadow: 0 0 60px #ff66ff, 0 0 120px #ff00ff, 0 0 180px #cc00cc;
  }
  @keyframes burstEnergy {
    0% { transform: scale(0); opacity: 0; }
    30% { transform: scale(2.5); opacity: 1; }
    50% { transform: scale(2); opacity: 1; }
    100% { transform: scale(4); opacity: 0; }
  }

  /* SHOCK - electric surge */
  .spell-shock {
    font-size: 160px;
    animation: shockZap 1.5s steps(4) forwards;
    text-shadow: 0 0 50px #ffff00, 0 0 100px #ffcc00, 0 0 150px #ff8800;
  }
  @keyframes shockZap {
    0% { transform: scale(0) translateX(-20px); opacity: 0; }
    25% { transform: scale(1.5) translateX(20px); opacity: 1; }
    50% { transform: scale(1.3) translateX(-15px); opacity: 1; }
    75% { transform: scale(1.6) translateX(10px); opacity: 0.8; }
    100% { transform: scale(2) translateX(0); opacity: 0; }
  }

  /* FREEZE - instant ice */
  .spell-freeze {
    font-size: 170px;
    animation: freezeSnap 2s ease-out forwards;
    text-shadow: 0 0 50px #88ffff, 0 0 100px #44ccff, 0 0 150px #0088ff;
    filter: brightness(1.3);
  }
  @keyframes freezeSnap {
    0% { transform: scale(0); opacity: 0; filter: blur(10px); }
    20% { transform: scale(1.8); opacity: 1; filter: blur(0); }
    40% { transform: scale(1.5); opacity: 1; }
    100% { transform: scale(1.5); opacity: 0; filter: blur(5px); }
  }

  /* DISPEL - magic shatter */
  .spell-dispel {
    font-size: 150px;
    animation: dispelShatter 2s ease-out forwards;
    text-shadow: 0 0 40px #ffffff, 0 0 80px #ccccff;
  }
  @keyframes dispelShatter {
    0% { transform: scale(1.5); opacity: 1; }
    30% { transform: scale(1.2) rotate(10deg); opacity: 1; }
    50% { transform: scale(1.3) rotate(-10deg); opacity: 1; }
    70% { transform: scale(1.1) rotate(5deg); opacity: 0.8; }
    100% { transform: scale(3); opacity: 0; filter: blur(10px); }
  }

  /* REFLECT - mirror shield */
  .spell-reflect {
    font-size: 140px;
    animation: reflectShimmer 2.5s ease-in-out forwards;
    text-shadow: 0 0 30px #88ccff, 0 0 60px #4488ff, 0 0 90px #0044cc;
    filter: brightness(1.2);
  }
  @keyframes reflectShimmer {
    0% { transform: scale(0) rotateY(0deg); opacity: 0; }
    30% { transform: scale(1.3) rotateY(180deg); opacity: 1; }
    60% { transform: scale(1.1) rotateY(360deg); opacity: 1; }
    100% { transform: scale(0.8) rotateY(540deg); opacity: 0; }
  }

  /* CHAIN - multi-hit lightning */
  .spell-chain {
    font-size: 150px;
    animation: chainBounce 2s steps(6) forwards;
    text-shadow: 0 0 40px #ffff88, 0 0 80px #ffcc00, 0 0 120px #ff8800;
  }
  @keyframes chainBounce {
    0% { transform: scale(0) translateX(-100px); opacity: 0; }
    20% { transform: scale(1.4) translateX(0); opacity: 1; }
    40% { transform: scale(1.2) translateX(80px); opacity: 1; }
    60% { transform: scale(1.5) translateX(-60px); opacity: 1; }
    80% { transform: scale(1.3) translateX(40px); opacity: 0.8; }
    100% { transform: scale(2) translateX(0); opacity: 0; }
  }

  /* MINI/TOAD - shrinking curse */
  .spell-mini {
    font-size: 100px;
    animation: miniShrink 2.5s ease-in-out forwards;
    text-shadow: 0 0 20px #88ff88, 0 0 40px #44cc44;
  }
  @keyframes miniShrink {
    0% { transform: scale(3); opacity: 0; }
    30% { transform: scale(1.5); opacity: 1; }
    60% { transform: scale(0.8); opacity: 1; }
    100% { transform: scale(0.3); opacity: 0; }
  }

  /* ZOMBIE - undead curse */
  .spell-zombie {
    font-size: 160px;
    animation: zombieRise 2.5s ease-out forwards;
    text-shadow: 0 0 40px #448844, 0 0 80px #226622, 0 0 120px #114411;
    filter: saturate(0.7) brightness(0.8);
  }
  @keyframes zombieRise {
    0% { transform: scale(0) translateY(100px); opacity: 0; }
    40% { transform: scale(1.3) translateY(-20px); opacity: 1; }
    60% { transform: scale(1.5) translateY(0); opacity: 1; }
    100% { transform: scale(1.8) translateY(-50px); opacity: 0; }
  }

  /* ARISE - necromantic revival */
  .spell-arise {
    font-size: 170px;
    animation: ariseGlow 3s ease-out forwards;
    text-shadow: 0 0 50px #aa00aa, 0 0 100px #660066, 0 0 150px #330033;
  }
  @keyframes ariseGlow {
    0% { transform: scale(0) translateY(80px); opacity: 0; filter: brightness(0.5); }
    40% { transform: scale(1.4) translateY(0); opacity: 1; filter: brightness(1.5); }
    70% { transform: scale(1.6) translateY(-30px); opacity: 1; filter: brightness(2); }
    100% { transform: scale(2) translateY(-80px); opacity: 0; filter: brightness(1); }
  }

  /* TIER 4 SPELLS - Firaja/Blizzaja/Thundaja */
  .spell-tier4 {
    font-size: 220px;
    animation: tier4Mega 3s ease-out forwards;
    filter: brightness(1.8) saturate(1.3);
  }
  @keyframes tier4Mega {
    0% { transform: scale(0) rotate(-180deg); opacity: 0; }
    25% { transform: scale(2) rotate(0deg); opacity: 1; }
    50% { transform: scale(1.8) rotate(90deg); opacity: 1; }
    75% { transform: scale(2.5) rotate(180deg); opacity: 0.9; }
    100% { transform: scale(4) rotate(360deg); opacity: 0; }
  }

  /* SUPERNOVA - cosmic destruction */
  .spell-supernova {
    font-size: 250px;
    animation: supernovaExplode 4s ease-out forwards;
    text-shadow: 0 0 80px #ffaa00, 0 0 160px #ff6600, 0 0 240px #ff0000;
    filter: brightness(2);
  }
  @keyframes supernovaExplode {
    0% { transform: scale(0); opacity: 0; filter: brightness(4); }
    20% { transform: scale(1.5); opacity: 1; filter: brightness(3); }
    40% { transform: scale(2.5); opacity: 1; filter: brightness(2); }
    70% { transform: scale(3); opacity: 0.9; filter: brightness(1.5); }
    100% { transform: scale(5); opacity: 0; filter: brightness(1); }
  }

  /* GIGAFLARE - ultimate dragon breath */
  .spell-gigaflare {
    font-size: 240px;
    animation: gigaflareBlast 3.5s ease-out forwards;
    text-shadow: 0 0 70px #ff4400, 0 0 140px #ff0000, 0 0 210px #880000;
  }
  @keyframes gigaflareBlast {
    0% { transform: scale(0) rotate(0deg); opacity: 0; }
    30% { transform: scale(2.5) rotate(180deg); opacity: 1; }
    60% { transform: scale(2) rotate(270deg); opacity: 1; }
    100% { transform: scale(4.5) rotate(360deg); opacity: 0; }
  }

  /* BLACKHOLE - ultimate gravity */
  .spell-blackhole {
    font-size: 200px;
    animation: blackholeCollapse 3s ease-in forwards;
    text-shadow: 0 0 60px #440088, 0 0 120px #220044, 0 0 180px #000000;
    filter: brightness(0.6);
  }
  @keyframes blackholeCollapse {
    0% { transform: scale(4); opacity: 0.3; }
    30% { transform: scale(2); opacity: 0.7; }
    60% { transform: scale(0.8); opacity: 1; }
    80% { transform: scale(0.3); opacity: 1; filter: brightness(0.3); }
    100% { transform: scale(0); opacity: 0; }
  }

  /* STARSTORM - celestial barrage */
  .spell-starstorm {
    font-size: 180px;
    animation: starstormRain 2.5s ease-out forwards;
    text-shadow: 0 0 50px #ffffff, 0 0 100px #ffffaa, 0 0 150px #ffff44;
  }
  @keyframes starstormRain {
    0% { transform: scale(0) translateY(-200px) rotate(-45deg); opacity: 0; }
    40% { transform: scale(1.5) translateY(0) rotate(0deg); opacity: 1; }
    70% { transform: scale(1.8) translateY(50px) rotate(15deg); opacity: 1; }
    100% { transform: scale(2.5) translateY(150px) rotate(45deg); opacity: 0; }
  }

  /* Water particles */
  .water-droplet {
    position: absolute;
    width: 12px;
    height: 18px;
    border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
    pointer-events: none;
    animation: dropletFall 1.5s ease-in forwards;
  }
  @keyframes dropletFall {
    0% { opacity: 0.9; transform: translateY(0) scale(1); }
    100% { opacity: 0; transform: translateY(120px) scale(0.5); }
  }

  /* Wind gust */
  .wind-gust {
    position: absolute;
    width: 100px;
    height: 3px;
    border-radius: 2px;
    pointer-events: none;
    animation: gustBlow 0.8s ease-out forwards;
  }
  @keyframes gustBlow {
    0% { opacity: 0.8; transform: translateX(0) scaleX(1); }
    100% { opacity: 0; transform: translateX(200px) scaleX(0.3); }
  }

  /* Star particle */
  .star-particle {
    position: absolute;
    width: 8px;
    height: 8px;
    pointer-events: none;
    animation: starTwinkle 1s ease-out forwards;
    clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
  }
  @keyframes starTwinkle {
    0% { opacity: 1; transform: scale(2) rotate(0deg); }
    50% { opacity: 1; transform: scale(1.5) rotate(180deg); }
    100% { opacity: 0; transform: scale(0) rotate(360deg); }
  }
</style>
</head>
<body>

<div class="mage-container">
  <img class="mage" src="file:///home/struktured/Pictures/redblackmage-transparent.png" alt="Red Black Mage">
</div>

<script>
// Spell definitions with their visual styles
const spellTypes = [
  // Fire magic
  { name: 'Fire', emoji: 'ðŸ”¥', class: 'spell-burst', color: '#ff6b6b', particles: 'normal' },
  { name: 'Fire2', emoji: 'ðŸ”¥', class: 'spell-burst', color: '#ff4400', particles: 'normal' },
  { name: 'Fire3', emoji: 'ðŸ”¥', class: 'spell-flare', color: '#ff2200', particles: 'normal' },
  // Ice magic
  { name: 'Blizzard', emoji: 'â„ï¸', class: 'spell-blizzard', color: '#00ffff', particles: 'ice' },
  { name: 'Blizzard2', emoji: 'â„ï¸', class: 'spell-blizzard', color: '#00ccff', particles: 'ice' },
  { name: 'Blizzard3', emoji: 'ðŸŒ¨ï¸', class: 'spell-blizzard', color: '#88ffff', particles: 'ice' },
  // Lightning magic
  { name: 'Thunder', emoji: 'âš¡', class: 'spell-burst', color: '#ffe66d', particles: 'normal' },
  { name: 'Thunder2', emoji: 'âš¡', class: 'spell-burst', color: '#ffcc00', particles: 'normal' },
  { name: 'Thunder3', emoji: 'âš¡', class: 'spell-flare', color: '#ffff00', particles: 'normal' },
  // Gravity/Space magic
  { name: 'Gravity', emoji: 'ðŸ•³ï¸', class: 'spell-gravity', color: '#8800ff', particles: 'gravity' },
  { name: 'Demi', emoji: 'â¬›', class: 'spell-gravity', color: '#6600aa', particles: 'gravity' },
  // Explosive magic
  { name: 'Flare', emoji: 'ðŸ’¥', class: 'spell-flare', color: '#ff6600', particles: 'normal' },
  { name: 'Ultima', emoji: 'âœ¨', class: 'spell-ultima', color: '#22ff22', particles: 'ultima' },
  { name: 'Holy', emoji: 'ðŸŒŸ', class: 'spell-ultima', color: '#ffffff', particles: 'holy' },
  // Apocalyptic magic
  { name: 'Doomsday', emoji: 'â˜„ï¸', class: 'spell-doomsday', color: '#880000', particles: 'doom' },
  { name: 'Meteor', emoji: 'â˜„ï¸', class: 'spell-meteor', color: '#ff4400', particles: 'meteor' },
  { name: 'Comet', emoji: 'ðŸ’«', class: 'spell-meteor', color: '#ff88ff', particles: 'normal' },
  { name: 'Quake', emoji: 'ðŸŒ‹', class: 'spell-doomsday', color: '#884400', particles: 'doom' },
  { name: 'Tornado', emoji: 'ðŸŒ€', class: 'spell-burst', color: '#88ccff', particles: 'normal' },
  // Poison/Bio magic
  { name: 'Bio', emoji: 'â˜ ï¸', class: 'spell-bio', color: '#88ff00', particles: 'poison' },
  { name: 'Bio2', emoji: 'â˜ ï¸', class: 'spell-bio', color: '#66cc00', particles: 'poison' },
  { name: 'Bio3', emoji: 'â˜ ï¸', class: 'spell-doomsday', color: '#44aa00', particles: 'poison' },
  { name: 'Poison', emoji: 'ðŸ§ª', class: 'spell-bio', color: '#aaff00', particles: 'poison' },
  // BLACK MAGIC - Dark spells
  { name: 'Dark', emoji: 'ðŸŒ‘', class: 'spell-dark', color: '#220044', particles: 'gravity' },
  { name: 'Darkra', emoji: 'ðŸŒ‘', class: 'spell-dark', color: '#330066', particles: 'gravity' },
  { name: 'Darkga', emoji: 'ðŸŒš', class: 'spell-doomsday', color: '#110022', particles: 'doom' },
  { name: 'Death', emoji: 'ðŸ’€', class: 'spell-gravity', color: '#440044', particles: 'gravity' },
  { name: 'Doom', emoji: 'â³', class: 'spell-curse', color: '#660066', particles: 'gravity' },
  { name: 'Curse', emoji: 'ðŸ”®', class: 'spell-curse', color: '#880088', particles: 'normal' },
  // Drain/Absorb magic
  { name: 'Drain', emoji: 'ðŸ©¸', class: 'spell-bio', color: '#cc0044', particles: 'poison' },
  { name: 'Osmose', emoji: 'ðŸ’œ', class: 'spell-burst', color: '#aa44ff', particles: 'normal' },
  { name: 'Absorb', emoji: 'ðŸ’«', class: 'spell-gravity', color: '#aa00aa', particles: 'gravity' },
  // Status magic
  { name: 'Sleep', emoji: 'ðŸ’¤', class: 'spell-sleep', color: '#8888ff', particles: 'normal' },
  { name: 'Sleepga', emoji: 'ðŸ˜´', class: 'spell-sleep', color: '#6666cc', particles: 'normal' },
  { name: 'Stop', emoji: 'â±ï¸', class: 'spell-stop', color: '#ffff00', particles: 'normal' },
  { name: 'Slow', emoji: 'ðŸ¢', class: 'spell-stop', color: '#cccc00', particles: 'normal' },
  { name: 'Break', emoji: 'ðŸ—¿', class: 'spell-break', color: '#888888', particles: 'normal' },
  { name: 'Stone', emoji: 'ðŸª¨', class: 'spell-break', color: '#666666', particles: 'normal' },
  { name: 'Blind', emoji: 'ðŸ‘ï¸â€ðŸ—¨ï¸', class: 'spell-dark', color: '#333333', particles: 'normal' },
  { name: 'Silence', emoji: 'ðŸ¤«', class: 'spell-curse', color: '#444488', particles: 'normal' },
  { name: 'Confuse', emoji: 'ðŸ˜µâ€ðŸ’«', class: 'spell-curse', color: '#ff88ff', particles: 'normal' },
  { name: 'Berserk', emoji: 'ðŸ˜¤', class: 'spell-flare', color: '#ff0000', particles: 'normal' },
  { name: 'Frog', emoji: 'ðŸ¸', class: 'spell-bio', color: '#00aa44', particles: 'poison' },
  // Ultimate black magic
  { name: 'Apocalypse', emoji: 'ðŸŒ‹', class: 'spell-doomsday', color: '#440000', particles: 'doom' },
  { name: 'Shadowflare', emoji: 'ðŸ”¥', class: 'spell-dark', color: '#440066', particles: 'doom' },
  { name: 'Void', emoji: 'âš«', class: 'spell-gravity', color: '#000000', particles: 'gravity' },
  // Water/Flood magic
  { name: 'Water', emoji: 'ðŸ’§', class: 'spell-water', color: '#0066ff', particles: 'water' },
  { name: 'Watera', emoji: 'ðŸ’§', class: 'spell-water', color: '#0088ff', particles: 'water' },
  { name: 'Waterga', emoji: 'ðŸŒŠ', class: 'spell-water', color: '#00aaff', particles: 'water' },
  { name: 'Flood', emoji: 'ðŸŒŠ', class: 'spell-water', color: '#0044cc', particles: 'water' },
  { name: 'Tsunami', emoji: 'ðŸŒŠ', class: 'spell-doomsday', color: '#0066aa', particles: 'water' },
  // Wind/Aero magic
  { name: 'Aero', emoji: 'ðŸŒ¬ï¸', class: 'spell-aero', color: '#88ffcc', particles: 'wind' },
  { name: 'Aerora', emoji: 'ðŸŒ¬ï¸', class: 'spell-aero', color: '#66ddaa', particles: 'wind' },
  { name: 'Aeroga', emoji: 'ðŸŒªï¸', class: 'spell-aero', color: '#44cc88', particles: 'wind' },
  // Nuclear/Fusion magic
  { name: 'Meltdown', emoji: 'â˜¢ï¸', class: 'spell-meltdown', color: '#ffff00', particles: 'ultima' },
  { name: 'Scathe', emoji: 'ðŸ’œ', class: 'spell-scathe', color: '#ff00ff', particles: 'normal' },
  { name: 'Burst', emoji: 'ðŸ’¥', class: 'spell-burst-energy', color: '#ff66ff', particles: 'ultima' },
  // Dimensional magic
  { name: 'Banish', emoji: 'âœï¸', class: 'spell-banish', color: '#ffffff', particles: 'holy' },
  { name: 'Warp', emoji: 'ðŸŒ€', class: 'spell-warp', color: '#8800ff', particles: 'gravity' },
  { name: 'X-Zone', emoji: 'âŒ', class: 'spell-warp', color: '#440088', particles: 'gravity' },
  // Ruin magic (FF13/14 style)
  { name: 'Ruin', emoji: 'ðŸ’¢', class: 'spell-ruin', color: '#440044', particles: 'doom' },
  { name: 'Ruinra', emoji: 'ðŸ’¢', class: 'spell-ruin', color: '#660066', particles: 'doom' },
  { name: 'Ruinga', emoji: 'ðŸ’¢', class: 'spell-doomsday', color: '#880088', particles: 'doom' },
  // Electric magic
  { name: 'Shock', emoji: 'âš¡', class: 'spell-shock', color: '#ffff00', particles: 'normal' },
  { name: 'Chain Lightning', emoji: 'âš¡', class: 'spell-chain', color: '#ffcc00', particles: 'normal' },
  { name: 'Judgement Bolt', emoji: 'âš¡', class: 'spell-tier4', color: '#ffff88', particles: 'ultima' },
  // Ice variants
  { name: 'Freeze', emoji: 'ðŸ§Š', class: 'spell-freeze', color: '#88ffff', particles: 'ice' },
  { name: 'Absolute Zero', emoji: 'â„ï¸', class: 'spell-tier4', color: '#aaffff', particles: 'ice' },
  // Support/Status magic
  { name: 'Dispel', emoji: 'âœ¨', class: 'spell-dispel', color: '#ffffff', particles: 'normal' },
  { name: 'Reflect', emoji: 'ðŸªž', class: 'spell-reflect', color: '#88ccff', particles: 'normal' },
  { name: 'Mini', emoji: 'ðŸœ', class: 'spell-mini', color: '#88ff88', particles: 'normal' },
  { name: 'Toad', emoji: 'ðŸ¸', class: 'spell-mini', color: '#44aa44', particles: 'poison' },
  { name: 'Pig', emoji: 'ðŸ·', class: 'spell-mini', color: '#ffaaaa', particles: 'normal' },
  // Undead magic
  { name: 'Zombie', emoji: 'ðŸ§Ÿ', class: 'spell-zombie', color: '#448844', particles: 'poison' },
  { name: 'Arise', emoji: 'ðŸ‘»', class: 'spell-arise', color: '#aa00aa', particles: 'gravity' },
  { name: 'Reraise', emoji: 'ðŸ‘¼', class: 'spell-arise', color: '#ffaaff', particles: 'holy' },
  // Tier 4 elemental
  { name: 'Firaja', emoji: 'ðŸ”¥', class: 'spell-tier4', color: '#ff2200', particles: 'meteor' },
  { name: 'Blizzaja', emoji: 'â„ï¸', class: 'spell-tier4', color: '#00ffff', particles: 'ice' },
  { name: 'Thundaja', emoji: 'âš¡', class: 'spell-tier4', color: '#ffff00', particles: 'ultima' },
  { name: 'Waterja', emoji: 'ðŸŒŠ', class: 'spell-tier4', color: '#0088ff', particles: 'water' },
  { name: 'Aeroja', emoji: 'ðŸŒªï¸', class: 'spell-tier4', color: '#88ffcc', particles: 'wind' },
  // Ultimate destruction
  { name: 'Supernova', emoji: 'ðŸŒŸ', class: 'spell-supernova', color: '#ffaa00', particles: 'ultima' },
  { name: 'Gigaflare', emoji: 'ðŸ‰', class: 'spell-gigaflare', color: '#ff4400', particles: 'meteor' },
  { name: 'Teraflare', emoji: 'ðŸ²', class: 'spell-supernova', color: '#ff0000', particles: 'doom' },
  { name: 'Exaflare', emoji: 'ðŸ’«', class: 'spell-supernova', color: '#ff6600', particles: 'meteor' },
  { name: 'Black Hole', emoji: 'ðŸ•³ï¸', class: 'spell-blackhole', color: '#220044', particles: 'gravity' },
  { name: 'Big Bang', emoji: 'ðŸ’¥', class: 'spell-supernova', color: '#ffffff', particles: 'ultima' },
  { name: 'Starstorm', emoji: 'â­', class: 'spell-starstorm', color: '#ffff88', particles: 'star' },
  // FF14/16 style
  { name: 'Xenoglossy', emoji: 'ðŸ“–', class: 'spell-scathe', color: '#aa44ff', particles: 'normal' },
  { name: 'Foul', emoji: 'ðŸ”®', class: 'spell-dark', color: '#660088', particles: 'gravity' },
  { name: 'Despair', emoji: 'ðŸ˜±', class: 'spell-curse', color: '#440066', particles: 'gravity' },
  { name: 'Akh Morn', emoji: 'ðŸ‰', class: 'spell-supernova', color: '#8844ff', particles: 'doom' },
  { name: 'Megaflare', emoji: 'ðŸ”¥', class: 'spell-gigaflare', color: '#ff8800', particles: 'meteor' },
  // Classic FF
  { name: 'Flare Star', emoji: 'ðŸŒ ', class: 'spell-tier4', color: '#ff8844', particles: 'meteor' },
  { name: 'Grand Cross', emoji: 'âœï¸', class: 'spell-warp', color: '#ffff00', particles: 'holy' },
  { name: 'Fallen One', emoji: 'ðŸ‘¹', class: 'spell-doomsday', color: '#880000', particles: 'doom' },
  { name: 'Heartless Angel', emoji: 'ðŸ˜‡', class: 'spell-banish', color: '#ffcccc', particles: 'holy' },
];

function castSpell() {
  const mageContainer = document.querySelector('.mage-container');
  const mageRect = mageContainer.getBoundingClientRect();
  const startX = mageRect.left + mageRect.width / 2;
  const startY = mageRect.top + 100;

  // Random target ANYWHERE on the entire 4K scene
  const targetX = Math.random() * 3600 + 100;
  const targetY = Math.random() * 1900 + 100;

  // Pick random spell
  const spell = spellTypes[Math.floor(Math.random() * spellTypes.length)];
  const color = spell.color;

  // Big flash at mage position
  const flash = document.createElement('div');
  flash.className = 'cast-flash';
  flash.style.left = (startX - 100) + 'px';
  flash.style.top = (startY - 100) + 'px';
  flash.style.background = color;
  document.body.appendChild(flash);
  setTimeout(() => flash.remove(), 500);

  // Trail particles from mage to target
  const trailCount = 20;
  for (let i = 0; i < trailCount; i++) {
    setTimeout(() => {
      const spark = document.createElement('div');
      spark.className = 'trail-spark';
      const progress = i / trailCount;
      const curve = Math.sin(progress * Math.PI) * 100;
      const x = startX + (targetX - startX) * progress + (Math.random() - 0.5) * 60 + curve;
      const y = startY + (targetY - startY) * progress + (Math.random() - 0.5) * 60 - curve * 0.5;
      spark.style.left = x + 'px';
      spark.style.top = y + 'px';
      spark.style.background = color;
      spark.style.boxShadow = `0 0 20px ${color}, 0 0 40px ${color}`;
      document.body.appendChild(spark);
      setTimeout(() => spark.remove(), 800);
    }, i * 25);
  }

  // Spell burst at target
  setTimeout(() => {
    // Main spell emoji with appropriate animation class
    const spellEl = document.createElement('div');
    spellEl.className = spell.class;
    spellEl.textContent = spell.emoji;
    spellEl.style.left = targetX + 'px';
    spellEl.style.top = targetY + 'px';
    spellEl.style.position = 'absolute';
    spellEl.style.pointerEvents = 'none';
    spellEl.style.color = color;
    document.body.appendChild(spellEl);
    setTimeout(() => spellEl.remove(), 4000);

    // Particle effects based on spell type
    if (spell.particles === 'gravity') {
      // Gravity: rings collapse inward
      for (let r = 0; r < 4; r++) {
        setTimeout(() => {
          const ring = document.createElement('div');
          ring.className = 'magic-ring gravity-ring';
          ring.style.left = (targetX + 60) + 'px';
          ring.style.top = (targetY + 60) + 'px';
          ring.style.width = '80px';
          ring.style.height = '80px';
          ring.style.marginLeft = '-40px';
          ring.style.marginTop = '-40px';
          ring.style.borderColor = color;
          ring.style.boxShadow = `0 0 30px ${color}`;
          document.body.appendChild(ring);
          setTimeout(() => ring.remove(), 1500);
        }, r * 200);
      }
    } else if (spell.particles === 'ice') {
      // Ice: shards fly outward
      for (let s = 0; s < 12; s++) {
        const shard = document.createElement('div');
        shard.className = 'ice-shard';
        const angle = (s / 12) * Math.PI * 2;
        const dist = 80 + Math.random() * 100;
        shard.style.left = (targetX + 60) + 'px';
        shard.style.top = (targetY + 60) + 'px';
        shard.style.borderBottomColor = color;
        shard.style.transform = `rotate(${angle}rad)`;
        shard.style.transition = 'all 1s ease-out';
        document.body.appendChild(shard);
        requestAnimationFrame(() => {
          shard.style.left = (targetX + 60 + Math.cos(angle) * dist) + 'px';
          shard.style.top = (targetY + 60 + Math.sin(angle) * dist) + 'px';
        });
        setTimeout(() => shard.remove(), 1000);
      }
    } else if (spell.particles === 'poison') {
      // Poison: bubbles float up
      for (let b = 0; b < 15; b++) {
        setTimeout(() => {
          const bubble = document.createElement('div');
          bubble.className = 'poison-bubble';
          bubble.style.left = (targetX + 40 + (Math.random() - 0.5) * 100) + 'px';
          bubble.style.top = (targetY + 60) + 'px';
          bubble.style.background = color;
          bubble.style.boxShadow = `0 0 15px ${color}`;
          document.body.appendChild(bubble);
          setTimeout(() => bubble.remove(), 2000);
        }, b * 100);
      }
    } else if (spell.particles === 'ultima' || spell.particles === 'holy') {
      // Ultima/Holy: massive expanding rings + particles
      for (let r = 0; r < 6; r++) {
        setTimeout(() => {
          const ring = document.createElement('div');
          ring.className = 'magic-ring';
          ring.style.left = (targetX + 80) + 'px';
          ring.style.top = (targetY + 80) + 'px';
          ring.style.width = '100px';
          ring.style.height = '100px';
          ring.style.marginLeft = '-50px';
          ring.style.marginTop = '-50px';
          ring.style.borderColor = color;
          ring.style.boxShadow = `0 0 40px ${color}, inset 0 0 30px ${color}`;
          document.body.appendChild(ring);
          setTimeout(() => ring.remove(), 1500);
        }, r * 100);
      }
      // Extra particles
      for (let p = 0; p < 24; p++) {
        const particle = document.createElement('div');
        particle.className = 'magic-particle';
        const angle = (p / 24) * Math.PI * 2;
        const dist = 150 + Math.random() * 200;
        particle.style.left = (targetX + 80) + 'px';
        particle.style.top = (targetY + 80) + 'px';
        particle.style.background = color;
        particle.style.boxShadow = `0 0 25px ${color}, 0 0 50px ${color}`;
        particle.style.transition = 'all 1.2s ease-out';
        particle.style.animation = 'none';
        document.body.appendChild(particle);
        requestAnimationFrame(() => {
          particle.style.left = (targetX + 80 + Math.cos(angle) * dist) + 'px';
          particle.style.top = (targetY + 80 + Math.sin(angle) * dist) + 'px';
          particle.style.opacity = '0';
        });
        setTimeout(() => particle.remove(), 1200);
      }
    } else if (spell.particles === 'doom' || spell.particles === 'meteor') {
      // Doom/Meteor: ground impact waves
      for (let r = 0; r < 5; r++) {
        setTimeout(() => {
          const ring = document.createElement('div');
          ring.className = 'magic-ring';
          ring.style.left = (targetX + 80) + 'px';
          ring.style.top = (targetY + 100) + 'px';
          ring.style.width = '120px';
          ring.style.height = '40px';
          ring.style.marginLeft = '-60px';
          ring.style.marginTop = '-20px';
          ring.style.borderColor = color;
          ring.style.boxShadow = `0 0 40px ${color}`;
          document.body.appendChild(ring);
          setTimeout(() => ring.remove(), 1500);
        }, r * 150);
      }
    } else if (spell.particles === 'water') {
      // Water: droplets falling
      for (let d = 0; d < 20; d++) {
        setTimeout(() => {
          const droplet = document.createElement('div');
          droplet.className = 'water-droplet';
          droplet.style.left = (targetX + 40 + (Math.random() - 0.5) * 120) + 'px';
          droplet.style.top = (targetY + 20) + 'px';
          droplet.style.background = color;
          droplet.style.boxShadow = `0 0 15px ${color}`;
          document.body.appendChild(droplet);
          setTimeout(() => droplet.remove(), 1500);
        }, d * 80);
      }
      // Wave rings
      for (let w = 0; w < 3; w++) {
        setTimeout(() => {
          const ring = document.createElement('div');
          ring.className = 'magic-ring';
          ring.style.left = (targetX + 60) + 'px';
          ring.style.top = (targetY + 80) + 'px';
          ring.style.width = '120px';
          ring.style.height = '30px';
          ring.style.marginLeft = '-60px';
          ring.style.marginTop = '-15px';
          ring.style.borderColor = color;
          ring.style.boxShadow = `0 0 25px ${color}`;
          document.body.appendChild(ring);
          setTimeout(() => ring.remove(), 1500);
        }, w * 200);
      }
    } else if (spell.particles === 'wind') {
      // Wind: gusts blowing outward
      for (let g = 0; g < 12; g++) {
        setTimeout(() => {
          const gust = document.createElement('div');
          gust.className = 'wind-gust';
          const angle = (Math.random() - 0.5) * Math.PI * 0.6;
          gust.style.left = (targetX + 60) + 'px';
          gust.style.top = (targetY + 60 + (Math.random() - 0.5) * 60) + 'px';
          gust.style.background = color;
          gust.style.boxShadow = `0 0 10px ${color}`;
          gust.style.transform = `rotate(${angle}rad)`;
          document.body.appendChild(gust);
          setTimeout(() => gust.remove(), 800);
        }, g * 60);
      }
      // Spiral particles
      for (let s = 0; s < 16; s++) {
        const particle = document.createElement('div');
        particle.className = 'magic-particle';
        const startAngle = (s / 16) * Math.PI * 2;
        particle.style.left = (targetX + 60) + 'px';
        particle.style.top = (targetY + 60) + 'px';
        particle.style.background = color;
        particle.style.boxShadow = `0 0 15px ${color}`;
        particle.style.transition = 'all 1.5s ease-out';
        document.body.appendChild(particle);
        requestAnimationFrame(() => {
          const endAngle = startAngle + Math.PI * 3;
          const dist = 150;
          particle.style.left = (targetX + 60 + Math.cos(endAngle) * dist) + 'px';
          particle.style.top = (targetY + 60 + Math.sin(endAngle) * dist - 100) + 'px';
          particle.style.opacity = '0';
        });
        setTimeout(() => particle.remove(), 1500);
      }
    } else if (spell.particles === 'star') {
      // Stars: twinkling star particles falling
      for (let s = 0; s < 24; s++) {
        setTimeout(() => {
          const star = document.createElement('div');
          star.className = 'star-particle';
          star.style.left = (targetX + 60 + (Math.random() - 0.5) * 200) + 'px';
          star.style.top = (targetY + (Math.random() - 0.5) * 150) + 'px';
          star.style.background = color;
          star.style.boxShadow = `0 0 20px ${color}`;
          document.body.appendChild(star);
          setTimeout(() => star.remove(), 1000);
        }, s * 50);
      }
      // Golden rings
      for (let r = 0; r < 5; r++) {
        setTimeout(() => {
          const ring = document.createElement('div');
          ring.className = 'magic-ring';
          ring.style.left = (targetX + 70) + 'px';
          ring.style.top = (targetY + 70) + 'px';
          ring.style.width = '80px';
          ring.style.height = '80px';
          ring.style.marginLeft = '-40px';
          ring.style.marginTop = '-40px';
          ring.style.borderColor = color;
          ring.style.boxShadow = `0 0 30px ${color}`;
          document.body.appendChild(ring);
          setTimeout(() => ring.remove(), 1500);
        }, r * 100);
      }
    } else {
      // Normal: standard expanding rings and particles
      for (let r = 0; r < 4; r++) {
        setTimeout(() => {
          const ring = document.createElement('div');
          ring.className = 'magic-ring';
          ring.style.left = (targetX + 50) + 'px';
          ring.style.top = (targetY + 50) + 'px';
          ring.style.width = '60px';
          ring.style.height = '60px';
          ring.style.marginLeft = '-30px';
          ring.style.marginTop = '-30px';
          ring.style.borderColor = color;
          ring.style.boxShadow = `0 0 30px ${color}, inset 0 0 20px ${color}`;
          document.body.appendChild(ring);
          setTimeout(() => ring.remove(), 1500);
        }, r * 120);
      }
      for (let p = 0; p < 16; p++) {
        const particle = document.createElement('div');
        particle.className = 'magic-particle';
        const angle = (p / 16) * Math.PI * 2;
        const dist = 100 + Math.random() * 150;
        particle.style.left = (targetX + 60) + 'px';
        particle.style.top = (targetY + 60) + 'px';
        particle.style.background = color;
        particle.style.boxShadow = `0 0 20px ${color}, 0 0 40px ${color}`;
        particle.style.transition = 'all 1s ease-out';
        particle.style.animation = 'none';
        document.body.appendChild(particle);
        requestAnimationFrame(() => {
          particle.style.left = (targetX + 60 + Math.cos(angle) * dist) + 'px';
          particle.style.top = (targetY + 60 + Math.sin(angle) * dist) + 'px';
          particle.style.opacity = '0';
        });
        setTimeout(() => particle.remove(), 1000);
      }
    }
  }, trailCount * 25 + 100);
}

// Cast spell every 12-25 seconds
function scheduleNextSpell() {
  const delay = 12000 + Math.random() * 13000;
  setTimeout(() => {
    castSpell();
    scheduleNextSpell();
  }, delay);
}

// First spell after 4 seconds
setTimeout(() => {
  castSpell();
  scheduleNextSpell();
}, 4000);
</script>
</body>
</html>
